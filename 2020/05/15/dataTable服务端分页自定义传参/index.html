<!DOCTYPE html>
<html>
  <head><meta name="generator" content="Hexo 3.9.0">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <title>just blue.</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
  <body>
    <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">just blue.</a>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">Home</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">Archives</a>
        </li>
      
        <li class="menu-item">
          <a href="/tags" class="menu-item-link">TAGS</a>
        </li>
      
        <li class="menu-item">
          <a href="/friends" class="menu-item-link">FRIENDS</a>
        </li>
      
    </ul>
  </nav>
</header>

    <main class="main">
      <article class="post">
  <div class="post-title">
    <h2 class="title">dataTable服务端分页自定义传参</h2>
  </div>
   <div class="post-meta">
    <span class="post-time">2020-05-15</span>
  </div>
  <div class="post-content">
    <p>1.关键代码,需要提前在html里定义好表格的标题,严格的table标签</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;table id=&quot;table&quot;&gt;</span><br><span class="line">	&lt;thead&gt;</span><br><span class="line">		&lt;th&gt;昵称&lt;/th&gt;</span><br><span class="line">		&lt;th&gt;头像&lt;/th&gt;</span><br><span class="line">		&lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">		&lt;th&gt;性别&lt;/th&gt;</span><br><span class="line">	&lt;/thead&gt;</span><br><span class="line">	&lt;tbody&gt;</span><br><span class="line">	&lt;/tbody&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>

<p>===</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">	//封装成方法,可以将想要传入服务器的值传入此方法,不限个数</span><br><span class="line">    function searchTableData(nickname,type_,openid,mobile,startdate,enddate) &#123;</span><br><span class="line">		if ($.fn.dataTable.isDataTable(&apos;#table&apos;))</span><br><span class="line">		&#123;</span><br><span class="line">			_table = $(&apos;#table&apos;).DataTable();</span><br><span class="line">			_table.destroy();</span><br><span class="line">		&#125;</span><br><span class="line">		var table=$(&apos;#table&apos;).DataTable(&#123;</span><br><span class="line">			&quot;lengthMenu&quot;: [10, 25, 50, 75, 100],</span><br><span class="line">			&quot;pageLength&quot;: 10,</span><br><span class="line">			&quot;stripeClasses&quot;: [&quot;odd&quot;, &quot;even&quot;],</span><br><span class="line">			&quot;olanguage&quot; : &#123;</span><br><span class="line">				&quot;processing&quot; : &quot;处理中...&quot;,</span><br><span class="line">				&quot;lengthMenu&quot; : &quot;每页显示 _MENU_ 条记录&quot;,</span><br><span class="line">				&quot;zeroRecords&quot; : &quot;没有检索到数据&quot;,</span><br><span class="line">				&quot;info&quot; : &quot;从 _START_ 到 _END_ /共 _TOTAL_ 条数据&quot;,</span><br><span class="line">				&quot;infoEmpty&quot; : &quot;没有数据&quot;,</span><br><span class="line">				&quot;search&quot; : &quot;搜索&quot;,</span><br><span class="line">				&quot;infoFiltered&quot; : &quot;(从 _MAX_ 条数据中检索)&quot;,</span><br><span class="line">				&quot;paginate&quot; : &#123;</span><br><span class="line">					&quot;first&quot; : &quot;首页&quot;,</span><br><span class="line">					&quot;previous&quot; : &quot;前一页&quot;,</span><br><span class="line">					&quot;next&quot; : &quot;后一页&quot;,</span><br><span class="line">					&quot;last&quot; : &quot;尾页&quot;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">			&quot;paginate&quot; : true,//开启分页</span><br><span class="line">			&quot;pagingType&quot;:&quot;simple_numbers&quot;,//分页的显示方式</span><br><span class="line">			&quot;destroy&quot;:true,</span><br><span class="line">			&quot;info&quot;:false,</span><br><span class="line">			&quot;lengthChange&quot;:true,</span><br><span class="line">			&quot;searching&quot;:false,</span><br><span class="line">			&quot;processing&quot;:true,</span><br><span class="line">			&quot;serverSide&quot;:true,//这个选项代表服务端分页,数据量大会一页一页查,这样就不会卡页面</span><br><span class="line">			&quot;ordering&quot;:false,</span><br><span class="line">			&quot;ajax&quot;:function(data,callback,setting)&#123;</span><br><span class="line">                debugger;</span><br><span class="line">                //封装请求参数</span><br><span class="line">                var param = &#123;&#125;;</span><br><span class="line">                param.limit = data.length;//页面显示记录条数，在页面显示每页显示多少项的时候</span><br><span class="line">                param.start = data.start;//开始的记录序号</span><br><span class="line">                param.page = (data.start / data.length)+1;//当前页码</span><br><span class="line">                param.startDate=startdate;</span><br><span class="line">                param.endDate=enddate;</span><br><span class="line">                param.nickname=nickname;</span><br><span class="line">                param.type_=type_;</span><br><span class="line">                param.openid=openid;</span><br><span class="line">                param.mobile=mobile;</span><br><span class="line">                //console.log(param);</span><br><span class="line">                //ajax请求数据</span><br><span class="line">                $.ajax(&#123;</span><br><span class="line">                    type: &quot;POST&quot;,</span><br><span class="line">                    url: &quot;$&#123;ctx&#125;/search&quot;,</span><br><span class="line">                    cache: false,  //禁用缓存</span><br><span class="line">                    data: param,  //传入组装的参数</span><br><span class="line">                    dataType: &quot;json&quot;,</span><br><span class="line">                    success: function (result) &#123;</span><br><span class="line">                        //console.log(result);</span><br><span class="line">						//result是一个json 有四个值</span><br><span class="line">						data,表格中需要显示的数据,是一个对象数组</span><br><span class="line">						draw,请求次数,请求的时候传过来的,需要再传回</span><br><span class="line">						recordsTotal,总的记录数</span><br><span class="line">						recordsFiltered,文档上说是筛选的记录数,实际上这个的值也是总记录数,否则只能看到一页的数据,真吭</span><br><span class="line">						</span><br><span class="line">						//传给dataTable的回调函数</span><br><span class="line">                        callback(result);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;columns&quot;: [</span><br><span class="line">                &#123; data: &apos;nick_name&apos; &#125;,</span><br><span class="line">                &#123; </span><br><span class="line">					data: &apos;head_pic&apos; ,</span><br><span class="line">					&quot;render&quot;: function (data, type, row, meta) &#123;</span><br><span class="line">						return &apos;&lt;img alt=&quot;image&quot; class=&quot;img-circle&quot; src=&quot;&apos;+data+&apos;&quot; style=&quot;width:50px;&quot;/&gt;&apos;;</span><br><span class="line">                    &#125;</span><br><span class="line">				&#125;,</span><br><span class="line">                &#123; </span><br><span class="line">					data: &apos;name&apos; ,</span><br><span class="line">					&quot;render&quot;: function (data, type, row, meta) &#123;</span><br><span class="line">						if(data == null)&#123;</span><br><span class="line">                            return &apos;&apos;;</span><br><span class="line">						&#125;else&#123;</span><br><span class="line">                            return data;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;,</span><br><span class="line">				&#123; </span><br><span class="line">					data: &apos;sex&apos;,</span><br><span class="line">					&quot;render&quot;: function (data, type, row, meta) &#123;</span><br><span class="line">                        if(data == 1)&#123;</span><br><span class="line">                            return &apos;男&apos;;</span><br><span class="line">                        &#125;else&#123;</span><br><span class="line">							return &apos;女&apos;;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">				&#125;,</span><br><span class="line">                &#123;</span><br><span class="line">					&quot;render&quot;:function(data,type,row,meta)&#123;</span><br><span class="line">                        return &apos;&lt;button class=&quot;btn btn-warning&quot; onclick=&quot;enable(\&apos;&apos; +row.id+ &apos;\&apos;)&quot;&gt;设置&lt;/button&gt;&apos;;</span><br><span class="line">                    &#125;</span><br><span class="line">				&#125;</span><br><span class="line">			]</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<a id="more"></a>
<p>2.在第3页更新了数据,如果重载页面会跳到第一页,可以使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&apos;#table&apos;).DataTable().draw()</span><br></pre></td></tr></table></figure>

<p>只刷新当前页的数据,用户体验会有提升</p>
<ol start="3">
<li>.DataTable()获取的是原生DataTable对象, .dataTable()获取的是JQuery对象<br>jquery.api()转成原生对象,DataTable.to$()</li>
</ol>

  </div>
</article>
    </main>
  <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>